---

import Layout from '../layouts/Layout.astro';
---

<Layout>
  <section class="container mx-auto py-12">
    <h1 class="text-3xl font-bold mb-4">Contact</h1>
    <form id="contact-form" class="space-y-4 max-w-lg mx-auto">
      <div>
        <label for="name" class="block font-semibold">Nom</label>
        <input id="name" name="name" type="text" required class="w-full border rounded px-3 py-2" />
      </div>
      <div>
        <label for="email" class="block font-semibold">Email</label>
        <input id="email" name="email" type="email" required class="w-full border rounded px-3 py-2" />
      </div>
      <div>
        <label for="message" class="block font-semibold">Message</label>
        <textarea id="message" name="message" required class="w-full border rounded px-3 py-2"></textarea>
      </div>
      <button type="submit" class="bg-primary text-white px-6 py-2 rounded">Envoyer</button>
      <div id="contact-feedback" class="mt-4 text-center"></div>
    </form>
    <script type="module">
      document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('contact-form');
        const feedback = document.getElementById('contact-feedback');
        if (form) {
          form.onsubmit = async function(e) {
            e.preventDefault();
            feedback.textContent = '';
            const name = form.name.value.trim();
            const email = form.email.value.trim();
            const message = form.message.value.trim();
            if (!name || !email || !message) {
              feedback.textContent = 'Veuillez remplir tous les champs.';
              feedback.className = 'mt-4 text-center text-red-600';
              return;
            }
            feedback.textContent = 'Envoi en cours...';
            feedback.className = 'mt-4 text-center text-gray-600';
            const res = await fetch('/api/contact', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ name, email, message })
            });
            if (res.ok) {
              form.reset();
              feedback.textContent = 'Message envoyé avec succès !';
              feedback.className = 'mt-4 text-center text-green-700';
            } else {
              feedback.textContent = "Erreur lors de l'envoi. Merci de réessayer.";
              feedback.className = 'mt-4 text-center text-red-600';
            }
          };
        }
      });
    </script>
  </section>
</Layout>
