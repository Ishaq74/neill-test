---
import Alert from './starwind/alert/Alert.astro';
let images = [];
let loading = true;
try {
  // On récupère toutes les images liées à une formation (formationsGlobal=1 ou formationId non nul)
  const res = await fetch('/api/galerie-db?formationsGlobal=1');
  if (res.ok) {
    images = await res.json();
  }
} catch {}
loading = false;
---
{!loading && images.length > 0 ? (
  <div class="w-full overflow-x-auto py-2">
    <div class="flex gap-4 min-w-full">
      {images.map((img: { imageUrl: string; title: string }) => (
        <div class="bg-white rounded-xl shadow p-2 min-w-[180px] max-w-xs flex-shrink-0 flex flex-col items-center">
          <img src={img.imageUrl} alt={img.title} class="w-40 h-32 object-cover rounded mb-2" loading="lazy" />
          <div class="text-xs text-gray-700 text-center">{img.title}</div>
        </div>
      ))}
    </div>
  </div>
) : (!loading && images.length === 0) ? (
  <Alert variant="info">Aucune image à afficher pour le moment.</Alert>
) : null}
